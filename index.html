<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mangaweb | Baca Manga Bahasa Indonesia</title>
    <meta name="description" content="Mangaweb adalah tempat baca manga online, anda bisa membacanya dengan gratis">
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Mangaweb" />
    <meta property="og:title" content="Mangaweb | Baca Manga Terlengkap" />
    <meta property="og:description" content="Platform baca Manga terbaru dan terlengkap. Berbagai judul leviathan dan manga lainnya bisa kalian baca secara gratis di mangaweb!" />
    <meta property="og:url" content="https://mangaweb.wuaze.com/" />
    <meta name="keywords" content="baca manga, manga bahasa indonesia, manga online" itemprop="keywords" />
    <meta content="Baca manga online terbaru hari ini Manga bisa kamu baca online gratis khusus bahasa Indonesia." itemprop="headline" />
    <meta content="https://mangaweb.wuaze.com" itemprop="url" />
    <link rel="icon" href="https://mangaweb.wuaze.com/res/image/icon.ico">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="https://mangaweb.wuaze.com/assets/logo.css" />
    <link rel="stylesheet" href="https://mangaweb.wuaze.com/assets/root.css" />
    <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
    />
    <meta name="theme-color" content="#F9C65C" />
    <style type="text/css" media="all">
:root {
        --bg: #f1f9f7;
        --c-1: #363a3a;
        --c-2: red;
        --c-3: #F9C65C;
    }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", Sans-Serif;
        }
        body {
            background: var(--bg);
        }
        #logo .logo {
            position: fixed;
            width: 100vw;
            height: 55px;
            background: var(--bg);
            display: flex;
            align-items: center;
            border-bottom: 0.05px solid black;
            z-index: 999;
        }
        #logo h1 {
            font-size: 1.7rem;
        }
        #logo h1 span:nth-child(1) {
            color: var(--c-1);
        }
        #logo h1 span:nth-child(2) {
            color: var(--c-2);
        }
        #logo .logo img {
            width: 40px;
            height: 40px;
        }
        #logo .logo .img1 {
            margin-right: auto;
            transform: translateX(10px);
        }
        #logo .logo .img2 {
            width: 30px;
            height: 30px;
            margin-left: auto;
            transform: translateX(-15px);
            cursor: pointer;
        }
        #logo .menu {
            z-index: 5;
            width: 100vw;
            background: var(--c-3);
            margin-top: 55px;
            position: fixed;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            display: grid;
            justify-content: center;
            align-content: center;
            text-align: center;
            gap: 20px;
            opacity: 1;
            transform: translateY(-500px);
            height: 35vh;
        }
        #logo .menu span {
            font-size: 1rem;
            color: black;
            transform: translateY(5px);
            text-transform: uppercase;
        }
        #logo .menu button {
            width: 80vw;
            height: 20px;
            text-align: center;
            justify-content: center;
            align-content: center;
            background: var(--bg);
            border: none;
            list-style: none;
            outline: none;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }
        #logo .search {
            position: fixed;
            width: 50vw;
            height: 25px;
            display: none;
            justify-content: center;
            align-items: center;
            margin-left: 50vw;
            background: var(--bg);
            box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.2);
            margin-top: 55px;
            border-bottom-left-radius: 50px;
            border-bottom-right-radius: 20px;
            z-index: 999;
        }
        #logo .search input {
            width: 130px;
            height: 20px;
            outline: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: none;
            border-bottom: 2px solid black;
            background: none;
            transform: translateX(5px);
            font-size: 16px;
        }
        #logo .search img {
            width: 30px;
            height: 30px;
            transform: translateX(10px);
            cursor: pointer;
        }
        .result-list {
            position: fixed;
            margin-left: 50vw;
            margin-top: 90px;
            width: 50vw;
            max-height: 250px;
            overflow-y: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 998;
        }
        .result-list li {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 15px;
        }
        .result-list li:hover {
            background: #eee;
        }
        #home h2 {
            text-align: center;
            padding: 20px;

        }
        #home .img-container {
            text-align: center;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
        }
        #home .img-container .op {
            background: var(--c-3);
            width: 95vw;
            height: 30px;
            border-top-right-radius: 50px;
            border-top-left-radius: 50px;
            justify-self: center;
            justify-content: center;
            align-content: center;
        }
        #home img {
            width: 100%;
            max-width: 800px;
            display: block;
            margin: 10px auto;
            border-radius: 10px;
            background: #333;
        }

        #home .loading {
            text-align: center;
            padding: 20px;
            font-size: 18px;
            color: #888;
        }
    </style>
</head>
<body>
    <section id="logo">
        <div class="logo">
            <img onclick="on()" class="img1" src="https://mangaweb.wuaze.com/res/image/menu.png" alt="" />
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><h1><span>xar</span><span>ware</span></h1></a>
            <img
            onclick="document.getElementById('search').style.display='flex';"
            class="img2"
            src="https://mangaweb.wuaze.com/res/image/search.png"
            alt=""
            />
        </div>
        <div id="menu" class="menu">
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><span>home</span></a>
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><span>contact</span></a>
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><span>about</span></a>
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><span>service</span></a>
            <button onclick="of()">sembunyikan</button>
        </div>
        <div class="search" id="search">
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><input type="search" placeholder="Cari topik..." /></a>
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><img
            onclick="document.getElementById('search').style.display='none'; document.getElementById('resultList').style.display='none';"
            src="https://mangaweb.wuaze.com/res/image/close.png"
            alt=""
            /></a>
        </div>
        <ul class="result-list" id="resultList"></ul>
        <div class="logo-bottom">
            <div class="icon-bottom">
                <i class=""></i>
            </div>
        </div>
    </section>
    <div style="width:100vw;height:50px;posisition:relative;"></div>
    <section id="home">
        <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><h2 id="judul">Memuat Komik...</h2></a>
        <div id="konten" class="img-container">
            <a style="color: black;text-decoration:none;" href="https://tpi.li/xarware"><div class="ov"></div></a>
        </div>
        <div id="loading" class="loading">
            Scroll ke bawah untuk lanjut...
        </div>

    </section>
    <script type="text/javascript" charset="utf-8">
        //logo
        const input = document.querySelector('#search input');
        const resultList = document.getElementById('resultList');
        let data = [];
        fetch('https://mangaweb.wuaze.com/assets/data.csv')
        .then(res => res.text())
        .then(text => {
            const lines = text.trim().split('\n');
            const headers = lines.shift().split(',');
            data = lines.map(line => {
                const [title, url] = line.split(',');
                return {
                    title, url
                };
            });
        });
        input.addEventListener('input', function () {
            const keyword = this.value.toLowerCase();
            resultList.innerHTML = '';
            if (!keyword) {
                resultList.style.display = 'none';
                return;
            }
            const filtered = data.filter(item =>
                item.title.toLowerCase().includes(keyword)
            ).slice(0, 20);

            if (filtered.length === 0) {
                resultList.innerHTML = '<li>Tidak ditemukan</li>';
            } else {
                filtered.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item.title;
                    li.onclick = () => window.location.href = item.url;
                    resultList.appendChild(li);
                });
            }
            resultList.style.display = 'block';
        });
        window.addEventListener('click', function (e) {
            if (!document.getElementById('search').contains(e.target)) {
                resultList.style.display = 'none';
            }
        });
        function on() {
            const elemen = document.getElementById('menu');
            elemen.style.setProperty('transform',
                'translateY(0)');
            elemen.style.setProperty('transition',
                'all 1s ease');

        }
        function of() {
            const elemen = document.getElementById('menu');
            elemen.style.setProperty('transform',
                'translateY(-500px');
            elemen.style.setProperty('transition',
                'all 1.5s ease');
        }
        //home
        let chapterIndex = 0;
        let dataKomik = null;
        let sedangMemuat = false;
        let imageMap = {}; // menyimpan gambar per chapter
        let gambarIndexMap = {}; // indeks gambar yang terakhir dimuat per chapter
        const konten = document.getElementById("konten");

        async function loadJSON() {
            const res = await fetch("https://mangaweb.wuaze.com/assets/data.json");
            const data = await res.json();
            dataKomik = data.chapters;
            document.querySelector(".ov").textContent = data.judul;
            muatGambarBerikutnya();
        }

        function muatGambarBerikutnya() {
            if (sedangMemuat) return;
            sedangMemuat = true;

            const chapter = dataKomik[chapterIndex];
            if (!chapter) {
                document.getElementById("loading").textContent = "✅ Semua chapter selesai!";
                sedangMemuat = false;
                return;
            }

            // Buat blok chapter jika belum ada
            // Buat blok chapter jika belum ada
            let divChapter = document.querySelector(`.chapter-block[data-chapter="${chapter.chapter}"]`);
            if (!divChapter) {
                divChapter = document.createElement("div");
                divChapter.className = "chapter-block";
                divChapter.dataset.chapter = chapter.chapter;

                // ✨ Tambahkan div.op dan masukkan teks ke dalamnya
                const opDiv = document.createElement("div");
                opDiv.className = "op";
                opDiv.textContent = `Chapter ${chapter.chapter}`;
                divChapter.appendChild(opDiv);

                konten.appendChild(divChapter);
                imageMap[chapter.chapter] = [];
                gambarIndexMap[chapter.chapter] = 0;
            }

            // Muat 3 gambar per scroll
            let startIndex = gambarIndexMap[chapter.chapter];
            let endIndex = Math.min(startIndex + 3, chapter.images.length);

            for (let i = startIndex; i < endIndex; i++) {
                const src = chapter.images[i];
                const img = document.createElement("img");
                img.loading = "lazy";
                img.src = src;
                divChapter.appendChild(img);
                imageMap[chapter.chapter].push(img);
            }

            gambarIndexMap[chapter.chapter] = endIndex;

            // Jika semua gambar pada chapter ini sudah dimuat, lanjut ke chapter berikutnya
            if (endIndex >= chapter.images.length) {
                chapterIndex++;
            }

            sedangMemuat = false;
        }

        function optimalkanMemori() {
            const blocks = document.querySelectorAll(".chapter-block");
            blocks.forEach(block => {
                const rect = block.getBoundingClientRect();
                const chapterId = block.dataset.chapter;

                if (rect.bottom < -200) {
                    // Jauh di atas viewport
                    const imgs = imageMap[chapterId];
                    if (imgs && imgs.length > 0) {
                        imgs.forEach(img => img.remove());
                        imageMap[chapterId] = [];
                        block.dataset.removed = "true";
                    }
                }

                if (rect.top > window.innerHeight + 500) {
                    // Jauh di bawah viewport (jika mau bisa unload juga)
                }

                if (block.dataset.removed === "true" && rect.top > -200 && rect.top < window.innerHeight + 200) {
                    // Reload ulang gambar jika pengguna scroll balik
                    const chapter = dataKomik.find(c => c.chapter === chapterId);
                    if (chapter) {
                        const indexTerakhir = gambarIndexMap[chapterId] || 0;
                        const divChapter = block;
                        for (let i = 0; i < indexTerakhir; i++) {
                            const img = document.createElement("img");
                            img.loading = "lazy";
                            img.src = chapter.images[i];
                            divChapter.appendChild(img);
                            imageMap[chapterId].push(img);
                        }
                        block.dataset.removed = "false";
                    }
                }
            });
        }

        window.addEventListener("scroll", () => {
            const jarakBawah = document.documentElement.scrollHeight - window.scrollY - window.innerHeight;
            if (jarakBawah < 200) {
                muatGambarBerikutnya();
            }

            optimalkanMemori();
        });

        loadJSON();
        //p
    </script>
</body>
</html>
